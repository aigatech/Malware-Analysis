# https://pytorch-geometric.readthedocs.io/en/latest/generated/torch_geometric.nn.conv.GCNConv.html#torch_geometric.nn.conv.GCNConv
# https://github.com/AntonioLonga/PytorchGeometricTutorial/blob/main/Tutorial6/Tutorial6.ipynb

import torch
from torch_geometric.nn import GCNConv
from dataclasses import dataclass

@dataclass
class ModelArgs:
    in_channels: int
    out_channels: int
    hidden_scaling_factor: int

class Encoder(torch.nn.Module):
    def __init__(self, args: ModelArgs) -> None:
        super().__init__()
        self.args = args
        self.conv1 = GCNConv(args.in_channels, args.out_channels * args.hidden_scaling_factor)
        self.conv2 = GCNConv(args.out_channels * args.hidden_scaling_factor, args.out_channels)
    
    def forward(x: torch.Tensor, edge_idx: torch.Tensor) -> torch.Tensor:
        x = self.conv1(x, edge_idx)
        x = x.relu()
        x = self.conv2(x, edge_idx)
        return x


